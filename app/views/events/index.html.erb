<div class="jumbotron">
  <h1>Welcome, <%= @user.first_name %>! <a class="btn btn-default" href="/users/<%= @user.id %>/edit">Edit Profile <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></h1>
  <p>See the events below!</p>
</div>

<div class="text-center">
  <% if @event.exists? %>
    <h3>Events in <%= @user.state %></h3>
    <table class="table table-bordered">
     <thead>
       <tr>
         <th class="text-center">Name</th>
         <th class="text-center">Date</th>
         <th class="text-center">Location</th>
         <th class="text-center">Host</th>
         <th class="text-center">Action/Status</th>
       </tr>
     </thead>
     <tbody>
       <% @event.each do |event| %>
       <tr>
         <td><a href="/events/<%= event.id %>"><%= event.name %></a></td>
         <td><%= event.date.strftime("%B %d, %Y") %></td>
         <td><%= event.city %></td>
         <td><%= event.host.first_name %></td>
         <td>
          <% if event.host.first_name == @user.first_name %>
            <a href="/events/<%= event.id %>/edit" class="btn btn-info">Edit <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
            <a href="/events/<%= event.id %>" class="btn btn-danger" data-method="delete">Delete <span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>
          <% else %>
            <% if event.users.exists?(session[:id]) %>
              Attending <a href="/attendees/<%= event.id %>/delete" data-method="delete" class="btn btn-danger">Cancel Plans</a>
            <% else %>
              <a href="/events/<%= event.id %>/join" class="btn btn-success">Join</a>
            <% end %>
          <% end %>
         </td>
       </tr>
       <% end %>
     </tbody>
    </table>
  <% else %>
    <h3>There are not any events in <%= @user.state %>!</h3>
  <% end %>
</div>

<div class="text-center">
  <% if @other_event.exists? %>
    <h3>Events in other states</h3>
      <table class="table table-bordered">
       <thead>
         <tr>
           <th class="text-center">Name</th>
           <th class="text-center">Date</th>
           <th class="text-center">Location</th>
           <th class="text-center">State</th>
           <th class="text-center">Host</th>
           <th class="text-center">Action/Status</th>
       </tr>
       </thead>
       <tbody>
         <% @other_event.each do |event| %>
         <tr>
           <td><a href="/events/<%= event.id %>"><%= event.name %></a></td>
           <td><%= event.date.strftime("%B %d, %Y") %></td>
           <td><%= event.city %></td>
           <td><%= event.state %></td>
           <td><%= event.host.first_name %></td>
           <td>
             <% if event.host.first_name == @user.first_name %>
                <a href="/events/<%= event.id %>/edit" class="btn btn-info">Edit <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
                <a href="/events/<%= event.id %>" class="btn btn-danger" data-method="delete">Delete <span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>
             <% else %>
                <% if event.users.exists?(session[:id]) %>
                  Attending <a href="/attendees/<%= event.id %>/delete" data-method="delete">Cancel</a>
                <% else %>
                  <a href="/events/<%= event.id %>/join">Join</a>
                <% end %>
             <% end %>
           </td>
         </tr>
         <% end %>
        </tbody>
      </table>
  <% else %>
      <h3>There are currently no events in other states!</h3>
  <% end %>
</div>

<h3>Add Event</h3>
<form class="form-inline" action="/events" method="post">
  <input type="hidden" name="authenticity_token" value="<%=form_authenticity_token%>">

  <div class="form-group">
    <label for="name">Name</label>
    <input type="text" class="form-control" name="event[name]" placeholder="Name">
  </div>

  <div class="form-group">
    <label for="date">Date</label>
    <input type="date" class="form-control" name="event[date]" placeholder="Date">
  </div>

  <div class="form-group">
    <label for="location">Location</label>
    <input type="text" class="form-control" name="event[city]" placeholder="Location">
  </div>

  <div class="form-group">
    <label for="state">State</label>
    <%= select_tag "event[state]", options_for_select(us_states) %>
  </div>

  <input type="hidden" name="event[host_id]" value="session[:id]"/>
  <button type="submit" class="btn btn-success">Submit</button>
</form>
